---
title: "Visualization"
output:
  learnr::tutorial:
      progressive: true
      allow_skip: true
runtime: shiny_prerendered
description: "Chapter 1 tutorial"
---

<!-- Ch. 1 tutorial questions written by Jessica Edwards  -->
<!-- Also taken from rstudio/learnr and rstudio-education/primers GitHub repos -->

```{r setup, include=FALSE}
library(tidyverse)
library(ggthemes)
library(viridis)
library(nycflights13)
library(PPBDS.data)
library(learnr)
library(learnrhash)
library(shiny)
knitr::opts_chunk$set(echo = FALSE, message = FALSE)
```

## What are R and RStudio?

```{r name, echo=FALSE}
question_text(
  "Student Name:",
  answer(NULL, correct = TRUE),
  incorrect = "Ok",
  try_again_button = "Modify your answer",
  allow_retry = TRUE
)
```

RStudio is an Integrated Development Environment for R. What does that mean? Well, if you think of R as a language, which it is, you can think of RStudio as a program that helps you write and work in the language. RStudio makes programming in R much easier and we suggest that you use it!

### Test your knowledge

```{r quiz3, echo=FALSE}
quiz(
  question("What are R and RStudio?",
             answer("R is a programming language and RStudio is an integrated development environment (IDE)", 
                    correct = TRUE),
             answer("RStudio is a programming language and R is an IDE"),
             answer("R and RStudio are both programming languages"),
             answer("R and RStudio are both IDEs"),
             allow_retry = TRUE
    ),
  question("What is the RStudio IDE?",
    answer("An application that makes it easier to use R.", correct = TRUE, message = "RStudio organizes your workspace and makes it easier to write, use, debug, and save R code. I highly recommend it and will rely on the RStudio IDE in several tutorials."),
    answer("An application that let's you use R without writing any code", message = "And thank goodness! Code provides a reproducible record of your work, which is essential for data science."),
    answer("A spreadsheet program like Microsoft Excel."),
    answer("Another name for R", message = "R and RStudio are two separate things. R is a language, like English. Think of RStudio as a program that helps you use the language, kind of like how a word processing program helps you write in English."),
    allow_retry = TRUE
  ),
  question("Do you need to install R if you already have RStudio?",
    answer("Yes.", correct = TRUE),
    answer("No.", message = "R does not come with RStudio; you need to install R separately.")
  ),
  question("In what order do you install R and RStudio?",
             answer("First R then RStudio", correct = TRUE),
             answer("First RStudio then R"),
             allow_retry = TRUE
    )
)
```

## How Do I Code in R?

R is easiest to use when you know how the R language works. This tutorial will teach you the implicit background knowledge that informs every piece of R code. You'll learn about:

* **functions** and their **arguments**
* **objects**
* R's basic **data types** 
* R's basic data structures including **vectors** and **lists**
* R's **package system**

### Functions 

Can you use the `sqrt()` function in the chunk below to compute the square root of 962?

```{r functions-1, exercise = TRUE}

```

Use the code chunk below to examine the code that `sqrt()` runs.

```{r functions-2, exercise = TRUE}
sqrt
```

Compare the code in `sqrt()` to the code in another R function, `lm()`. Examine `lm()`'s code body in the chunk below.

```{r functions-3, exercise = TRUE}
lm
```

### help pages

Wow! `lm()` runs a lot of code. What does it do? Open the help page for `lm()` in the chunk below and find out.

```{r functions-4, exercise = TRUE}

```

### Code comments

What do you think the chunk below will return? Run it and see. The result should be nothing. R will not run anything on a line after a `#` symbol. This is useful because it lets you write human readable comments in your code: just place the comments after a `#`. Now delete the `#` and re-run the chunk. You should see a result.

```{r functions-5, exercise = TRUE}
# sqrt(961)
```

### Objects

#### Object names

You can choose almost any name you like for an object, as long as the name does not begin with a number or a special character like `+`, `-`, `*`, `/`, `^`, `!`, `@`, or `&`. 

```{r objects-1, echo = FALSE}
question("Which of these would be valid object names?",
  answer("today", correct = TRUE),
  answer("1st"),
  answer("+1"),
  answer("vars", correct = TRUE),
  answer("\\^_^"),
  answer("foo", correct = TRUE),
  allow_retry = TRUE,
  correct = "Remember that the most helpful names will remind you what you put in your object."
)
```

#### Using objects

In the code chunk below, save the results of `rnorm(100, mean = 100, sd = 15)` to an object named `data`. Then, on a new line, call the `hist()` function on `data` to plot a histogram of the random values.

```{r objects-2, exercise = TRUE}

```

#### What if?

What do you think would happen if you assigned `data` to a new object named `copy`, like this? Run the code and then inspect both `data` and `copy`.

```{r objects-3, exercise = TRUE}
data <- rnorm(100, mean = 100, sd = 15)
copy <- data
```

```{r objects-3-check}
"Good job! R saves a copy of the contents in data to copy."
```

#### Data sets

Objects provide an easy way to store data sets in R. In fact, R comes with many toy data sets pre-loaded. Examine the contents of `iris` to see a classic toy data set. Hint: how could you learn more about the `iris` object?

```{r objects-4, exercise = TRUE}

```

### Vectors

#### Create a vector

In the chunk below, create a vector that contains the integers from one to ten.

```{r vectors-1, exercise = TRUE}

```

```{r vectors-1-hint}
c(....)
```

#### :

If your vector contains a sequence of contiguous integers, you can create it with the `:` shortcut. Run `1:10` in the chunk below. What do you get? What do you suppose `1:20` would return?

```{r vectors-2, exercise = TRUE}

```

#### []

You can extract any element of a vector by placing a pair of brackets behind the vector. Inside the brackets place the number of the element that you'd like to extract. For example, `vec[3]` would return the third element of the vector named `vec`.

Use the chunk below to extract the fourth element of `vec`.

```{r vectors-3, exercise = TRUE}
vec <- c(1, 2, 4, 8, 16)
```

#### More []

You can also use `[]` to extract multiple elements of a vector. Place the vector `c(1,2,5)` between the brackets below. What does R return?

```{r vectors-4, exercise = TRUE}
vec <- c(1, 2, 4, 8, 16)
vec[]
```

#### Names

If the elements of your vector have names, you can extract them by name. To do so place a name or vector of names in the brackets behind a vector. Surround each name with quotation marks, e.g. `vec2[c("alpha", "beta")]`.

Extract the element named gamma from the vector below.

```{r vectors-5, exercise = TRUE}
vec2 <- c(alpha = 1, beta = 2, gamma = 3)
```

#### Vectorised operations

Predict what the code below will return. Then look at the result.

```{r vectors-6, exercise = TRUE}
c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10) + c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10)
```

```{r vectors-6-check}
"Good job! Like many R functions, R's math operators are vectorised: they're designed to work with vectors by repeating the operation for each pair of elements."
```

#### Vector recycling

Predict what the code below will return. Then look at the result.

```{r vectors-7, exercise = TRUE}
1 + c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10)
```

```{r vectors-7-check}
"Good job! Whenever you try to work with vectors of varying lengths (recall that `1` is a vector of length one), R will repeat the shorter vector as needed to compute the result."
```

### Types

#### Data types
 
```{r flights3, echo = FALSE}
flights
``` 
 
Did you notice that a row of three (or four) letter abbreviations appears under the column names of `flights`? These abbreviations describe the _type_ of data that is stored in each column of `flights`:

* `int` stands for integers.

* `dbl` stands for doubles, or real numbers.

* `chr` stands for character vectors, or strings.

* `dttm` stands for date-times (a date + a time).

There are three other common types of variables that aren't used in this dataset but are used in other datasets:

* `lgl` stands for logical, vectors that contain only `TRUE` or `FALSE`.

* `fctr` stands for factors, which R uses to represent categorical variables
  with fixed possible values.

* `date` stands for dates.

This row of data types is unique to tibbles and is one of the ways that tibbles try to be more user-friendly than data frames.

#### Vectors

```{r types5, echo = FALSE}
question('How many types of data can you put into a single vector?',
         answer("1", correct = TRUE),
         answer("6"),
         answer("As many as you like"),
         allow_retry = TRUE)
```

#### Character or object?

One of the most common mistakes in R is to call an object when you mean to call a character string and vice versa.

```{r types6, echo = FALSE}
question('Which of these are object names? What is the difference between object names and character strings?',
         answer("foo", correct = TRUE),
         answer('"num"'),
         answer("mu", correct = TRUE),
         answer('"sigma"'),
         answer('"data"'),
         answer("a", correct = TRUE),
         allow_retry = TRUE,
         correct = "Character strings are surrounded by quotation marks, object names are not.")
```

### Lists 

#### Lists vs. vectors

```{r lists1, echo = FALSE}
question('Which data structure(s) could you use to store these pieces of data in the same object? `1001`, `TRUE`, `"stories"`.',
         answer("a vector"),
         answer("a list", correct = TRUE),
         answer("neither"),
         allow_retry = TRUE)
```

#### Make a list

Make a list that contains the elements `1001`, `TRUE`, and `"stories"`. Give each element a name.

```{r lists2, exercise = TRUE}

```

#### Extract an element

Extract the number 1001 from the list below.

```{r lists3, exercise = TRUE}
things <- list(number = 1001, logical = TRUE, string = "stories")
```

#### Data Frames

You can make a data frame with the `data.frame()` function, which works similar to `c()`, and `list()`. Assemble the vectors below into a data frame with the column names `numbers`, `logicals`, `strings`.

```{r lists4, exercise = TRUE}
nums <- c(1, 2, 3, 4)
logs <- c(TRUE, TRUE, FALSE, TRUE)
strs <- c("apple", "banana", "carrot", "duck")
```

#### Extract a column

Given that a data frame is a type of list (with named elements), how could you extract the strings column of the `df` data frame below? Do it.

```{r lists5, exercise = TRUE}
nums <- c(1, 2, 3, 4)
logs <- c(TRUE, TRUE, FALSE, TRUE)
strs <- c("apple", "banana", "carrot", "duck")
df <- data.frame(numbers = nums, logicals = logs, strings = strs)
```

## What are R packages?

### Packages

#### A common error

```{r packages1, echo = FALSE}
question('What does this common error message suggest? `object _____ does not exist.`',
         answer("You misspelled your object name"),
         answer("You've forgot to load the package that ____ comes in"),
         answer("Either", correct = TRUE),
         allow_retry = TRUE)
```

#### Load a package

In the code chunk below, load the `tidyverse` package. Whenever you load a package R will also load all of the packages that the first package depends on. `tidyverse` takes advantage of this to create a shortcut for loading several common packages at once. Whenever you load `tidyverse`, `tidyverse` also loads `ggplot2`, `dplyr`, `tibble`, `tidyr`, `readr`, and `purrr`.

```{r packages2, exercise = TRUE}

```

#### Quotes

Did you know, `library()` is a special function in R? You can pass `library()` a package name in quotes, like `library("tidyverse")`, or not in quotes, like `library(tidyverse)`---both will work! That's often not the case with R functions.

#### Install packages

But what if the package that you want to load is not installed on your computer? How would you install the dplyr package on your own computer?

```{r packages3, exercise = TRUE}

```

```{r packages3-check}
"Good job! You only need to install a package once, unless you wish to update your local copying by reinstalling the package. Notice that `install.packages()` _always_ requires quotes around the package name."
```

### Test your knowledge

```{r names, echo = FALSE}
quiz(caption = "Quiz - Working with Packages",
  question("What command do you use to install packages?",
    answer("`library()`", message = "We will see what `library()` does later."),
    answer("`install.packages()`", correct = TRUE),
    answer("`install_packages()`"),
    answer("There is no command. You must visit [cran.r-project.org](http://cran.r-project.org) and download packages manually.", message = "R makes it easy to download packages. You connect to the internet and then run one of the commands above."),
    allow_retry = TRUE
  ),
  question("How often do you need to install a package on your computer?",
    answer("Every time you restart R"),
    answer("Every time you restart your computer"),
    answer("Only once. Afterwards, R can find it on your hard drive as needed.", correct = TRUE),
    answer("Never, as long as you are connected to the internet.", message = "This could be true if you are using R over a cloud service. However, if you are using R locally on your own computer, you will need to install each package that you use on your computer."),
    allow_retry = TRUE
  ),
  question("Which of the following is NOT true about R packages?",
           answer("R packages extend the functionality of R by providing additional functions, data, and documentation"),
           answer("If comparing R and R packages to a phone, R would be the apps you can download on the phone and R packages would be the phone", correct = TRUE),
           answer("R packages are written by a worldwide community of R users"),
           answer("R packages can be downloaded for free from the Internet"),
           allow_retry = TRUE
  )
)
```

*Load the `ggplot2` package using `library()`.*

```{r exercise-1, exercise = TRUE, exercise.lines = 3}

```

## Explore your first datasets

### `trains` dataset

*Load the `PPBDS.data` package to look at the `trains` dataset.*
```{r exercise-2, exercise = TRUE, exercise.lines = 5}

  
trains
```

*Use the `glimpse()` function to look at the `trains` dataset. We already loaded the `dplyr` and `PPBDS.data` packages.*
```{r exercise-4, exercise = TRUE, exercise.lines = 5}
library(dplyr)
library(PPBDS.data)


```

```{r quiz-4, echo = FALSE}
quiz(caption = "Quiz - `trains` dataset",
  question("What is the data type of the `liberal` variable?",
           answer("character"),
           answer("logical", correct = TRUE),
           answer("double"),
           answer("factor"),
           allow_retry = TRUE
  ),
  question("How many rows does the `train` dataset have?",
           answer("8"),
           answer("15"),
           answer("115", correct = TRUE),
           allow_retry = TRUE
  )
)
```

*Extract the `income` variable in the `trains` dataset using the `$` operator.*
```{r exercise-5, exercise = TRUE}

```

### `qscores` dataset

*Look at the `qscores` dataset using `glimpse()`. We have loaded the `PPBDS.data` and the `dplyr` packages.*

```{r qscores, exercise = TRUE, exercise.lines = 5}

```

```{r quiz-5, echo = FALSE}
quiz(
  question("Which of the following is NOT an identification variable? (choose 2)",
           answer("`course_name`"),
           answer("`department`", correct = TRUE),
           answer("`workload`", correct = TRUE),
           answer("`course_number`"),
           allow_retry = TRUE
  )
)
```

## Data Visualization using the ggplot2 package

### Components of a graphic

```{r quiz-6, echo = FALSE}
quiz(
  question("What are the three essential components of a graphic?",
           answer("the dataset containing the variables in question", correct = TRUE),
           answer("the geometric object we can observe in a plot", correct = TRUE),
           answer("axes labels on a plot"),
           answer("the aesthetic attributes", correct = TRUE),
           allow_retry = TRUE
  ),
  question("What are the two important arguments that we need to provide the `ggplot()` function?",
           answer("`data` and `mapping`", correct = TRUE),
           answer("`data` and `aesthetics`"),
           answer("`data` and `layers`"),
           allow_retry = TRUE
  )
)
```

### Components of a scatterplot

*Look at this scatterplot made using the `trains` dataset. Higher numbers mean more conservative attitudes toward immigration-related policies on a 3 to 15 scale. Individuals with a treatment value of "Treated" were exposed to two Spanish-speakers on their regular commute. "Control" individuals were not.*

```{r trains}
ggplot(data = trains, mapping = aes(x = att_start, y = att_end, color = treatment)) +
  geom_point() + facet_wrap(~party)
```

```{r quiz-7, echo = FALSE}
quiz(
  question("Which `data` variable is mapped to the `x`-position `aes`thetic of the points?",
           answer("`att_start`", correct = TRUE),
           answer("`att_end`"),
           answer("`treatment`"),
           allow_retry = TRUE
  ),
  question("Which `data` variable is mapped to the `y`-position `aes`thetic of the points?",
           answer("`att_start`"),
           answer("`att_end`", correct = TRUE),
           answer("`treatment`"),
           allow_retry = TRUE
  ),
  question("Which `data` variable is mapped to the `color` `aes`thetic of the points?",
           answer("`att_start`"),
           answer("`att_end`"),
           answer("`treatment`", correct = TRUE),
           allow_retry = TRUE
  )
)
```

## Summary of Geoms

### Test Your Knowledge

```{r geoms, echo = FALSE}
quiz(
  question("Which plot(s) show the relationship between 2 numerical variables?",
           answer("scatterplot", correct = TRUE),
           answer("lineplot", correct = TRUE),
           answer("histogram"),
           answer("boxplot"),
           answer("barplot"),
           allow_retry = TRUE
  ),
  question("Which plot(s) show the distribution of 1 numerical variable?",
           answer("scatterplot"),
           answer("lineplot"),
           answer("histogram", correct = TRUE),
           answer("boxplot", correct = TRUE),
           answer("barplot"),
           allow_retry = TRUE
  ),
  question("Which plot(s) show the distribution of 1 categorical variable?",
           answer("scatterplot"),
           answer("lineplot"),
           answer("histogram"),
           answer("boxplot"),
           answer("barplot", correct = TRUE),
           allow_retry = TRUE
  ),
  question("Which of the following is NOT a geometric object?",
           answer("`geom_scatter()`", correct = TRUE),
           answer("`geom_line()`"),
           answer("`geom_histogram()`"),
           answer("`geom_boxplot()`"),
           answer("`geom_bar()`"),
           allow_retry = TRUE
  )
)
```

## Scatterplots

### Scatterplot with the `qscores` dataset

*Let's make a scatterplot using the `qscores` dataset. Load the `PPBDS.data` package and look at the `qscores` dataset by simply typing the name of the dataset.*

```{r exercise-6, exercise = TRUE, exercise.lines = 5}

```

```{r exercise-6-hint}
library(...)

...
```

###

*Load the `ggplot2` package. Use the `ggplot()` function to create a scatterplot using the `qscores` dataset, `rating` on the x-axis and `hours` on the y-axis. Is there a relationship between the rating of a Harvard course versus the average hours per week of workload?*

```{r exercise-7, exercise = TRUE, exercise.lines = 5}

```

```{r exercise-7-hint}
library(...)

ggplot(data = qscores, mapping = aes(x = ..., y = ...)) +
  ...
```

###

*Now we want to add a `size` `aes`thetic based on the number of students enrolled in each course. Add `size = enrollment` to the other `aes`thetics of the points. Do larger classes have a higher average overall course rating? What about higher workload?*

```{r exercise-8, exercise = TRUE, exercise.lines = 5}
ggplot(data = qscores, mapping = aes(x = rating, y = hours)) +
  geom_point()
```

```{r exercise-8-hint}
ggplot(data = qscores, mapping = aes(x = rating, y = hours, size = ...)) +
  geom_point()
```

### Overplotting

While this plot created using the `mpg` dataset only displays 126 points, it visualizes a data set that contains 234 points.

```{r echo = FALSE, out.width = "80%"}
ggplot(data = mpg) +
  geom_point(mapping = aes(x = displ, y = hwy))
```

The missing points are hidden behind other points, a phenomenon known as _overplotting_. Overplotting is a problem because it provides an incomplete picture of the dataset. You cannot determine where the *mass* of the points fall, which makes it difficult to spot relationships in the data. 

### Causes of overplotting

Overplotting usually occurs for two different reasons:

1. The data points have been rounded to a "grid" of common values, as in the plot above
2. The dataset is so large that it cannot be plotted without points overlapping each other

How you deal with overplotting will depend on the cause. 

### Changing the transparency

If your overplotting is due to rounding, you can obtain a better picture of the data by making each point semi-transparent. For example you could _set_ the alpha aesthetic of the plot below to a _value_ less than one, which will make the points transparent. 

Try this now. Set the points to an alpha of 0.2, which will make each point 20% opague (i.e. five points staked on top of each other will create a solid black).

*Change the transparency of the points by setting `alpha = 0.2` within `geom_point()`.*

```{r exercise-9, exercise = TRUE, exercise.lines = 5}
ggplot(data = qscores, mapping = aes(x = rating, y = hours, size = enrollment)) +
  geom_point()
```

```{r exercise-9-hint}
ggplot(data = qscores, mapping = aes(x = rating, y = hours, size = enrollment)) +
  geom_point(alpha = ...)
```

### Adjusting the position

A second strategy for dealing with overplotting due to rounding is to adjust the position of each point. `geom_jitter()` plots a scatterplot and then adds a small amount of random noise to each point in the plot. It is a shortcut for adding a "jitter" position adjustment to a points plot (i.e, `geom_point(position = "jitter")`). Since the noise is random, it is unlikely that two points rounded to the same location will also be jittered to the same location. The result is a jittered plot that displays more of the data and provides a simple way to inspect patterns that occur in heavily gridded or overlapping data. 

*Replace `geom_point()` with `geom_jitter()` to create a jittered scatterplot.*

```{r exercise-10, exercise = TRUE, exercise.lines = 5}
ggplot(data = qscores, mapping = aes(x = rating, y = hours)) +
  geom_point()
```

### Strategies for large data

Alpha and jittering are less useful for large data. Jittering will not separate the points, and a mass of transparent points can still look black.

A better way to deal with overplotting due to large data is to visualize a summary of the data, by using a histogram or a linegraph, for example.

## Linegraphs

```{r linegraphs-setup, include = FALSE}
cces_data <- cces %>%
  filter(approval_ch %in% c("Approve / Somewhat Approve", "Disapprove / Somewhat Disapprove")) %>%
  group_by(year, approval_ch) %>%
  summarize(avg_age = mean(age))
```

*The `cces` dataset in the `PPBDS.data` package has been changed to show the average age of voters per year based on their approval of the president that year. The `cces` dataset was manipulated using the `filter()`, `group_by`, and `summarize()` functions within the `tidyverse` package, which you will learn how to use in the next chapter.*

```{r gov_qscores, echo = TRUE}
cces_data
```

*Use the `ggplot()` function to create a linegraph with the dataset called `cces_data` with `year` on the x-axis, `avg_age` on the y-axis, and `approval_ch` as the color aesthetic.*

```{r exercise-11, exercise = TRUE, exercise.lines = 5}

```

```{r exercise-11-hint}
ggplot(data = cces_data, mapping = aes(x = ..., y = ..., color = ...)) +
  geom_line()
```

### Test your knowledge

```{r quiz-8, echo = FALSE}
quiz(
  question("True / False: Linegraphs and scatterplots both display the relationship between two numerical variables.",
           answer("True", correct = TRUE),
           answer("False"),
           allow_retry = TRUE),
  question("True / False: It is preferred to use scatterplots over linegraphs when the variable on the x-axis has an inherent ordering, like in a time series plot.",
           answer("True"),
           answer("False", correct = TRUE),
           allow_retry = TRUE)
)
```

## Histograms

### Test your knowledge

```{r quiz-9, echo = FALSE}
quiz(
  question("A histogram is:",
           answer("A plot that displays the relationship between two numerical variables"),
           answer("A plot that visualizes the distribution of a numerical variable", correct = TRUE),
           answer("A plot that visualizes the distribution of a categorical variable"),
           allow_retry = TRUE)
)
```

###

*Using the `qscores` dataset and `ggplot()`, make a histogram where `rating` is on the x-axis to see the distribution of Harvard course ratings.*

```{r exercise-12, exercise = TRUE, exercise.lines = 5}

```

```{r exercise-12-hint}
ggplot(data = ..., mapping = aes(x = ...)) + ...
```

```{r quiz-10, echo = FALSE}
quiz(
  question_text("What is the default value of bins for this histogram?",
                answer("30", correct = TRUE), 
                allow_retry = TRUE)
)
```

###

*Add white vertical borders demarcating the bins by adding `color = "powderblue"` and `fill = "violet"` arguments to `geom_histogram()`.*

```{r exercise-13, exercise = TRUE, exercise.lines = 5}
ggplot(data = qscores, mapping = aes(x = overall)) +
  geom_histogram()
```

```{r exercise-13-hint}
ggplot(data = qscores, mapping = aes(x = overall)) + 
  geom_histogram(color = ..., fill = ...)
```

###

*Specify the number of bins to be 10 via the `bins` argument and the `color` as "white" in `geom_histogram()`.*

```{r exercise-14, exercise = TRUE, exercise.lines = 5}
ggplot(data = qscores, mapping = aes(x = overall)) +
  geom_histogram()
```

```{r exercise-14-hint}
ggplot(data = qscores, mapping = aes(x = overall)) +
  geom_histogram(bins = ..., color = ...)
```

###

*Specify the width of the bins to be 1 via the `binwidth` argument and the `color` as "white" in `geom_histogram()`.*

```{r exercise-15, exercise = TRUE, exercise.lines = 5}
ggplot(data = qscores, mapping = aes(x = overall)) +
  geom_histogram()
```

```{r exercise-15-hint}
ggplot(data = qscores, mapping = aes(x = overall)) +
  geom_histogram(binwidth = ..., color = ...)
```

## Boxplots

```{r quiz-11, echo = FALSE}
quiz(
  question("Which of the following are included in the five-number summary of a numerical variable used to construct a boxplot?",
           answer("Minimum", correct = TRUE),
           answer("First quartile", correct = TRUE),
           answer("Median", correct = TRUE),
           answer("Mean"),
           answer("Third quartile", correct = TRUE),
           answer("Maximum", correct = TRUE)
  )
)
```

*Let's keep playing with the `qscores` dataset in the `PPBDS.data` package. We have filtered the dataset using the `tidyverse` package based on the five departments with the classes with the most enrollment: ECON, COMPSCI, STAT, GOV, and MATH. (You will learn how to do this in the next chapter). The filtered dataset is called `top_five_qscores`.*

```{r boxplot-setup, include = FALSE}
top_five_enrolled <- qscores %>% 
  group_by(department) %>%
  summarize(enrollment = sum(enrollment)) %>% 
  arrange(desc(enrollment)) %>%
  pull(department)

top_five_qscores <- qscores %>% filter(department %in% top_five_enrolled[0:5])
```

```{r boxplot-top-five-qscores, echo = TRUE}
top_five_qscores
```

*Using the `top_five_qscores` dataset and `ggplot()`, make a boxplot where `department` is on the x-axis and `overall` is on the y-axis.*

```{r exercise-16, exercise = TRUE, exercise.lines = 5}

```

```{r exercise-16-hint}
ggplot(data = ..., mapping = aes(x = ..., y = ...)) +
  ...
```

```{r quiz-12, echo = FALSE}
quiz(
  question("Which department has the highest median course rating?",
           answer("COMPSCI"),
           answer("ECON"),
           answer("GOV"),
           answer("MATH", correct = TRUE),
           answer("STAT")
  ),
  question("Which department has outliers?",
           answer("COMPSCI"),
           answer("ECON"),
           answer("GOV"),
           answer("MATH", correct = TRUE),
           answer("STAT")
  ),
  question("Which department has the largest range of course ratings?",
           answer("COMPSCI"),
           answer("ECON"),
           answer("GOV", correct = TRUE),
           answer("MATH"),
           answer("STAT")
  )
)
```

## Barplots

```{r quiz-13, echo = FALSE}
quiz(
  question("A barplot is:",
           answer("A plot that displays the relationship between two numerical variables"),
           answer("A plot that visualizes the distribution of a numerical variable"),
           answer("A plot that visualizes the distribution of a categorical variable",
                  correct = TRUE),
           allow_retry = TRUE)
)
```

###

*We can now use a barplot to plot how many students are enrolled in classes per department. We will use the `top_five_qscores` dataset again to look at the five largest departments.*

```{r barplot-setup, include = FALSE}
top_five_enrolled <- qscores %>% 
  group_by(department) %>%
  summarize(enrollment = sum(enrollment)) %>% 
  arrange(desc(enrollment)) %>%
  pull(department)

top_five_qscores <- qscores %>% filter(department %in% top_five_enrolled[0:5])
```

```{r barplot-top-five-qscores, echo = TRUE}
top_five_qscores
```

*Use `ggplot()` and `geom_bar()` to plot `department` on the x-axis to see the number of classes in each department.*

```{r exercise-17, exercise = TRUE, exercise.lines = 5}

```

```{r exercise-17-hint}
ggplot(data = ..., mapping = aes(x = ...)) +
  ...
```

###

*We can then count the number of classes per department in order to use the `geom_col()` layer instead. We do this using the `group_by()` and `count()` functions in the `tidyverse` package, which you will learn how to use in the next chapter. Our new data frame is stored as `top_five_qscores_counted`.*

```{r classes-counted-setup, include = FALSE}
top_five_qscores_counted <- top_five_qscores %>% 
  group_by(department) %>% count() %>% rename(count = n)
```

```{r avg-workload-setup, echo = TRUE}
top_five_qscores_counted
```

*Use `ggplot()` and `geom_col()` to plot `department` on the x-axis and `count` on the y-axis to see the number of classes in each department.*

```{r exercise-18, exercise = TRUE, exercise.lines = 5}

```

```{r exercise-18-hint}
ggplot(data = top_five_qscores_counted, mapping = aes(x = ..., y = ...)) +
  ...
```

```{r quiz-14, echo = FALSE}
quiz(
  question("What's the difference between `geom_bar()` and `geom_col()`?",
           answer("`geom_bar()` is used to represent pre-counted data while `geom_col() is not."),
           answer("`geom_col()` is used to represent pre-counted data while `geom_bar() is not.", 
                  correct = TRUE),
           answer("There is no difference between the two layers.")
  )
)
```

###

*Let's go back to the `trains` dataset in the `PPBDS.data` package. Use `ggplot()` and `geom_bar()` to plot `treatment` on the x-axis.*

```{r exercise-19, exercise = TRUE, exercise.lines = 5}

```

```{r exercise-19-hint}
ggplot(data = ..., mapping = aes(x = ...)) + ...
```

###

*We can now map the additional variable `party` by adding a `fill = party` inside the `aes()` aesthetic mapping.*

```{r exercise-20, exercise = TRUE, exercise.lines = 5}
ggplot(data = trains, mapping = aes(x = treatment)) + geom_bar()
```

```{r exercise-20-hint}
ggplot(data = trains, mapping = aes(x = treatment, fill = ...)) + geom_bar()
```

###

*Change `fill = party` to `color = party`. What happens? *

```{r exercise-21, exercise = TRUE, exercise.lines = 5}
ggplot(data = trains, mapping = aes(x = treatment, fill = party)) + geom_bar()
```

###

*Create a side-by-side barplot by adding `position = "dodge"` to `geom_bar()`.*

```{r exercise-22, exercise = TRUE, exercise.lines = 5}
ggplot(data = trains, mapping = aes(x = treatment, fill = party)) +
  geom_bar()
```

```{r exercise-22-hint}
ggplot(data = trains, mapping = aes(x = treatment, fill = party)) +
  geom_bar(position = ...)
```

###

*Instead of mapping `party` to `fill`, we can include it as the variable to create small multiples of the plot across the levels of `party` using `facet_wrap(~ party)`. Add this layer to the provided plot in order to create a faceted barplot.*

```{r exercise-23, exercise = TRUE, exercise.lines = 5}
ggplot(data = trains, mapping = aes(x = treatment)) + 
  geom_bar()
```

```{r exercise-23-hint}
ggplot(data = trains, mapping = aes(x = treatment)) + geom_bar() + ...
```

## More Layers

We can add more layers in order to customize the look and feel of your plots. This section will teach you how to:

* Add **labels** and **annotations** to your plots
* Change the appearance of your plot with a **theme**
* Modify the labels, title, and position of **legends**
* Provide breaks and labels for axes and legends using **scales**
* Adjust the **position** for barplots and scatterplots
* Break up a plot into several plots using **faceting**
* Change the **coordinate system** of a plot
* Add **statistical** transformations to a plot
* Adjust axes limits using **xlim** and **ylim**
* Adding text to a plot using **ggtext**

### Labels

#### labs()

Let's use the `diamonds` dataset to make a plot that uses boxplots to display the relationship between the `cut` and `price` variables from the diamonds dataset. This plot has been created and saved as an object called `p`.

The relationship in our plot is now easier to see, but that doesn't mean that everyone who sees our plot will spot it. We can draw their attention to the relationship with a label, like a title or a caption.

To do this, we will use the `labs()` function. You can think of `labs()` as an all purpose function for adding labels to a ggplot2 plot.

#### Titles

Give `labs()` a `title` argument to add a title.

```{r}
p <- ggplot(diamonds) +
  geom_boxplot(mapping = aes(x = cut, y = price))
```

```{r}
p <- ggplot(diamonds) +
  geom_boxplot(mapping = aes(x = cut, y = price))
```

```{r out.width = "80%"}
p + labs(title = "The title appears here")
```

#### Subtitles

Give `labs()` a `subtitle` argument to add a subtitle. If you use multiple arguments, remember to separate them with a comma.

```{r out.width = "80%"}
p + labs(title = "The title appears here",
         subtitle = "The subtitle appears here, slightly smaller")
```

#### Captions

Give `labs()` a `caption` argument to add a caption. I like to use captions to cite my data source.

```{r out.width = "80%"}
p + labs(title = "The title appears here",
         subtitle = "The subtitle appears here, slightly smaller",
         caption = "Captions appear at the bottom.")
```

#### Exercise - Labels

Plot `p` with a set of informative labels. For learning purposes, be sure to use a title, subtitle, and caption.

```{r r5-setup}
p <- ggplot(diamonds) +
  geom_boxplot(mapping = aes(x = cut, y = price)) + 
  coord_cartesian(ylim = c(0, 7500))
```

```{r r5, exercise = TRUE}

```

#### Exercise 3 - Carat size? 

Perhaps a diamond's cut is conflated with its carat size. If fair cut diamonds tend to be larger diamonds that would explain their larger prices. Let's test this.

Make a plot that displays the relationship between carat size, price, and cut for all diamonds. How do you interpret the results? Give your plot a title, subtitle, and caption that explain the plot and convey your conclusions.

If you are looking for a way to start, I recommend using a smooth line with color mapped to cut, perhaps overlaid on the background data.

```{r r6, exercise = TRUE}

```

```{r r6-hint}
ggplot(data = diamonds, mapping = aes(x = carat, y = price)) +
  geom_smooth(mapping = aes(color = cut), se = FALSE) + 
  labs(....)
```

#### p1

Unlike `p`, our new plot uses color and has a legend. Let's save it to use later when we learn to customize colors and legends.

```{r out.width = "80%"}
p1 <- ggplot(data = diamonds, mapping = aes(x = carat, y = price)) +
  geom_smooth(mapping = aes(color = cut), se = FALSE) + 
  labs(title = "Carat size vs. Price",
       subtitle = "Fair cut diamonds tend to be large, but they fetch the lowest prices for most carat sizes.",
       caption = "Data by Hadley Wickham")
```

### Themes

One of the most effective ways to control the look of your plot is with a theme.

#### What is a theme?

A theme describes how the non-data elements of your plot should look. For example, these two plots show the same data, but they use two very different themes.

```{r echo = FALSE, out.width ="50%", message = FALSE, warning = FALSE}
p1 + theme_bw()
p1 + theme_economist()
```

#### Theme functions

To change the theme of your plot, add a `theme_` function to your plot call. The ggplot2 package provides eight theme functions to choose from.

* `theme_bw()`
* `theme_classic()`
* `theme_dark()`
* `theme_gray()`
* `theme_light()`
* `theme_linedraw()`
* `theme_minimal()`
* `theme_void()`

Use the box below to plot `p1` with each of the themes. Which theme do you prefer? Which theme does ggplot2 apply by default?

```{r r7, exercise = TRUE}
p1 + theme_bw()
```

#### ggthemes

If you would like to give your graph a more complete makeover, the **ggthemes** package provides extra themes that imitate the graph styles of popular software packages and publications. These include:

* `theme_base()`
* `theme_calc()`
* `theme_economist()`
* `theme_economist_white()`
* `theme_excel()`
* `theme_few()`
* `theme_fivethirtyeight()`
* `theme_foundation()`
* `theme_gdocs()`
* `theme_hc()`
* `theme_igray()`
* `theme_map()`
* `theme_pander()`
* `theme_par()`
* `theme_solarized()`
* `theme_solarized_2()`
* `theme_solid()`
* `theme_stata()`
* `theme_tufte()`
* `theme_wsj()`

Try plotting `p1` with at least two or three of the themes mentioned above.

```{r r8, exercise = TRUE}
p1
```

#### Update p1

If you compare the ggtheme themes to the styles they imitate, you might notice something: the colors used to plot your data haven't changed. The colors are noticeably ggplot2 colors. In the next section, we'll look at how to customize this remaining part of your graph: the data elements.

Before we go on, I suggest that we update `p1` to use `theme_bw()`. It will make our next set of modifications easier to see.

```{r p1, out.width = "80%", messages = FALSE}
p1 <- p1 + theme_bw()
p1
```

### Legends

#### Customizing a legend

The last piece of a ggplot2 graph to customize is the legend. When it comes to legends, you can customize the:

* position of the legend within the graph
* the "type" of the legend, or whether a legend appears at all
* the title and labels in the legend

Customizing legends is a little more chaotic than customizing other parts of the graph, because the information that appears in a legend comes from several different places.

#### Positions

To change the position of a legend in a ggplot2 graph add one of the below to your plot call:

* `+ theme(legend.position = "bottom")`
* `+ theme(legend.position = "top")`
* `+ theme(legend.position = "left")`
* `+ theme(legend.position = "right")` (the default)

Try this now. Move the legend in `p_cont` to the bottom of the graph.

```{r r14, exercise = TRUE}

```

#### theme() vs. themes

Theme functions like `theme_grey()` and `theme_bw()` also adjust the legend position (among all of the other details they orchestrate). So if you use `theme(legend.position = "bottom")` in your plots, be sure to add it _after_ any `theme_` functions you call, like this

```{r r15, exercise = TRUE, exercise.eval = TRUE, out.width = "80%"}
ggplot(data = mpg) + 
  geom_jitter(mapping = aes(x = displ, y = hwy, color = hwy)) +
  theme_bw() +
  theme(legend.position = "bottom")
```

If you do this, ggplot2 will apply all of the settings of `theme_bw()`, and then overwrite the legend position setting to "bottom" (instead of vice versa).

#### Types

You may have noticed that color and fill legends take two forms. If you map color (or fill) to a discrete variable, the legend will look like a standard legend. This is the case for the bottom legend below. 

If you map color (or fill) to a continuous legend, your legend will look like a colorbar. This is the case in the top legend below. The color bar helps convey the continuous nature of the variable.

```{r plegend-setup}
p_legend <- ggplot(data = mpg) + 
  geom_jitter(mapping = aes(x = displ, y = hwy, color = class, fill = hwy), 
              shape = 21, size = 3, stroke = 1) +
  theme_bw()

p_legend
```

#### Changing type

You can use the `guides()` function to change the type or presence of each legend in the plot. To use `guides()`, type the name of the aesthetic whose legend you want to alter _as and argument name_. Then set it to one of

* `"legend"` - to force a legend to appear as a standard legend instead of a colorbar
* `"colorbar"` - to force a legend to appear as a colorbar instead of a standard legend. Note: this can only be used when the legend can be printed as a colorbar (in which case the default will be colorbar).
* `"none"` - to remove the legend entirely. This is useful when you have redundant aesthetic mappings, but it may make your plot indecipherable otherwise.

```{r plegend, out.width = "80%"}
p_legend + guides(fill = "legend", color = "none")
```

#### Exercise - guides()

Use `guides()` to remove each legend from the `p_legend` plot.

```{r r16, exercise = TRUE, exercise.setup = "plegend"}

```

#### Labels

To control the title and labels of a legend, you must turn to the `scale_` functions. Each `scale_` function takes a name and a labels argument, which it will use to build the legend associated with the scale. The labels argument should be a vector of strings that has one string for each label in the default legend.

So for example, you can adjust the legend of p1 with

```{r out.width = "80%"}
p1 + scale_color_brewer(name = "Cut Grade", labels = c("Very Bad", "Bad", "Mediocre", "Nice", "Very Nice"))
```

#### What if?

This is handy, but it raises a question: what if you haven't invoked a `scale_` function to pass labels to? For example, the graph below relies on the default scales.

```{r echo = FALSE, out.width = "80%"}
p1
```

#### Default scales

In this case, you need to identify the default scale used by the plot and then manually add that scale to the plot, setting the labels as you do. 

For example, our plot above relies on the default color scale for a discrete variable, which happens to be `scale_color_discrete()`. If you know this, you can relabel the legend like so:

```{r out.width = "80%"}
p1 + scale_color_discrete(name = "Cut Grade", labels = c("Very Bad", "Bad", "Mediocre", "Nice", "Very Nice"))
```

#### Scale defaults

As you can see, it is handy to know which scales a ggplot2 graph will use by default. Here's a short list.

aesthetic	| variable   |	default
--------- | ---------- | -------------------------
x	        | continuous |	scale_x_continuous()
	        | discrete   |	scale_x_discrete()
y	        | continuous |	scale_y_continuous()
	        | discrete	 |  scale_y_discrete()
color	    | continuous |	scale_color_continuous()
	        | discrete	 |  scale_color_discrete()
fill	    | continuous |	scale_fill_continuous()
	        | discrete   |	scale_fill_discrete()
size	    | continuous |	scale_size()
shape	    | discrete	 | scale_shape()

#### Exercise - Legends

Use the list of scale defaults above to relabel the legend in `p_cont`. The legend should have the title "Highway MPG". Also place the legend at the top of the plot.

```{r r17, exercise = TRUE}
p_cont
```

```{r r17-hint}
p_cont + scale_color_continuous(...) + theme(...)
```

#### Axis labels

In ggplot2, the axes are the "legends" associated with the $x$ and $y$ aesthetics. As a result, you can control axes titles and labels in the same way as you control legend titles and labels:

```{r}
p1 + scale_x_continuous(name = "Carat Size", labels = c("Zero", "One", "Two", "Three", "Four", "Five"))
```

### Scales

#### What is a scale?

Every time you map an aesthetic to a variable, ggplot2 relies on a _scale_ to select the specific colors, sizes, or shapes to use for the values of your variable. 

A scale is an R function that works like a mathematical function; it maps each value in a data space to a level in an aesthetic space. But it may be easier to think of a scale as a "palette." When you give your graph a color scale, you give it a palette of colors to use.

#### Using scales

ggplot2 chooses a pleasing set of scales to use whenever you make a graph. You can change or customize these scales by adding a scale function to your plot call. 

For example, the code below plots `p1` in greyscale instead of the default colors.

```{r}
p1 + scale_color_grey()
```

#### A second example

You can add scales for every aesthetic mapping, including the $x$ and $y$ mappings (the code below log transforms the x and y axes). 

```{r}
p1 +
  scale_x_log10() + 
  scale_y_log10()
```

ggplot2 supplies over 50 scales to use. This may seem overwhelming, but the scales are organized according to an intuitive naming convention.

#### Naming convention

ggplot2 scale functions follow a naming convention. Each function name contains the same three elements in order, separated by underscores:

* The prefix `scale` 
* the name of an aesthetic, which the scale adjusts (e.g. `color`, `fill`, `size`)
* a unique label for the scale (e.g. `grey`, `brewer`, `manual`)

`scale_shape_manual()` and `scale_x_continuous()` are examples of the naming scheme.

You can see the complete list of scale names at [http://ggplot2.tidyverse.org/reference/](http://ggplot2.tidyverse.org/reference/). In this tutorial, we will focus on scales that work with the color aesthetic.

#### Discrete vs. continuous

Scales specialize in either _discrete_ variables or _continuous_ variables. In other words, you would use a different set of scales to map a discrete variable, like diamond clarity, than you would use to map a continuous variable, like diamond price.

```{r q1, echo = FALSE}
question("Which type of variable does `p1` map to the color aesthetic?",
         answer("Discrete", correct = TRUE, message = "p1 maps color to cut, a discrete variable with five distinct levels."),
         answer("Continuous"),
         allow_retry = TRUE)
```

#### scale_color_brewer

One of the most useful color palettes for discrete variables is `scale_color_brewer()` (`scale_fill_brewer()` if you are working with fill. Run the code below to see the effect of the scale.

```{r make_p1, include = FALSE}
p1 <- ggplot(data = diamonds, mapping = aes(x = carat, y = price)) +
  geom_smooth(mapping = aes(color = cut), se = FALSE) + 
  labs(title = "Carat size vs. Price",
       subtitle = "Fair cut diamonds tend to be large, but they fetch the lowest prices for most carat sizes.",
       caption = "Data by Hadley Wickham") + theme_bw()
```

```{r r9, exercise = TRUE, warning = FALSE, message = FALSE, exercise.setup="make_p1"}
p1 + scale_color_brewer()
```

#### RColorBrewer

The RColorBrewer package contains a variety of palettes developed by Cynthis Brewer. Each palette is designed to look pleasing as well as to differentiate between the values represented by the palette. You can learn more about the color brewer project at [colorbrewer2.org](http://colorbrewer2.org).

Altogether, the RColorBrewer package contains 35 palettes. You can see each palette and its name by running `RColorBrewer::display.brewer.all()`. Try it below.

```{r r10, exercise = TRUE, warning = FALSE, message = FALSE, fig.width=4, fig.height = 7}

```

#### Brewer palettes

By default, `scale_color_brewer()` will use the "Blues" palette from the RColorBrewer package. To use a different RColorBrewer palette, set the palette argument of `scale_color_brewer()` to one of the RColorBrewer palette names, surrounded by quotation marks, e.g.

```{r warnings = FALSE, out.width = "80%"}
p1 + scale_color_brewer(palette = "Purples")
```

#### Exercise - scale_color_brewer()

Recreate the graph below, which uses a different palette from the RColorBrewer package.

```{r echo = FALSE, out.width = "80%"}
p1 + scale_color_brewer(palette = "Spectral")
```

```{r r11, exercise = TRUE, warning = FALSE, message = FALSE, exercise.setup="make_p1"}


```

```{r r11-hint}
palette = "Spectral"
```

#### Continuous colors

`scale_color_brewer()` works with discrete variables, but what if your plot maps color to a continuous variable?

Since we do not have a plot that applies color to a continuous variable, let's make one. 

```{r}
p_cont <- ggplot(data = mpg) + 
  geom_jitter(mapping = aes(x = displ, y = hwy, color = hwy)) +
  theme_bw()

p_cont
```

#### Discrete vs. continuous in action

If we apply `scale_color_brewer()` to our new plot, we get an error message that confirms what you know: you cannot use a scale that is built for discrete variables to customize the mapping to a continuous variable. Uncomment the code to see the error.

```{r cont, exercise = TRUE}
# p_cont + scale_color_brewer()
```

#### distiller

Luckily, `scale_color_brewer()` has a comes with a continuous analogue named `scale_color_distiller()` (also `scale_fill_distiller()`). 

Use `scale_color_distiller()` just as you would `scale_color_brewer()`. `scale_color_distiller()` will take any RColorBrewer palette, and interpolate between colors as necessary to provide an entire continuous range of colors.

So for example, we could reuse the Spectral palette in our continuous plot

```{r}
p_cont + scale_color_distiller(palette = "Spectral")
```

#### Exercise - scale_color_distiller()

Recreate the graph below, which uses a different palette from the RColorBrewer package.

```{r echo = FALSE, out.width = "80%"}
p_cont + scale_color_distiller(palette = "BrBG")
```

```{r r12, exercise = TRUE, warning = FALSE, message = FALSE, exercise.setup="make_p1"}

```

#### viridis

The viridis package contains a collection of very good looking color palettes for continuous variables. Each palette is designed to show the gradation of continuous values in an attractive, and perceptionally uniform way (no range of values appears more important than another). As a bonus, the palettes are both color blind and black and white printer friendly!

To add a viridis palette, use `scale_color_viridis()` or `scale_fill_viridis()`, both of which come in the viridis package.

```{r}
p_cont + scale_color_viridis()
```

#### viridis options

Altogether, the viridis package comes with four color palettes, named magma, plasma, inferno, and viridis.

However, you do not select the palettes by name. To select a viridis color palette, set the `option` argument of `scale_color_viridis()` to one of `"A"` (magma), `"B"` (plasma), `"C"` (inferno), or `"D"` (viridis). 

Try each option with `p_cont` below. Determine which is the default.

```{r r13, exercise = TRUE, warning = FALSE, message = FALSE, exercise.setup="make_p1"}

```

### Positions

### Faceting

### Coordinate Systems

### Stats

### Adjusting Axes Limits

### Adding Text to a Plot

## Using Functions in the Tidyverse

### The pipe operator: `%>%`
### `filter()`
### `select()`
### `slice()`, `pull()`, and `[]`
### `arrange()`
### `group_by()`
### `mutate()`

## Data Types and Factors

### The forcats package
### Dropping unused levels
### Change order of the levels
### Recode the levels
### Grow a factor

## Importing Data

### Comma Separated Values `.csv` file
### Excel `.xlsx` spreadsheet
### Google Sheets file

## Submit

```{r encode, echo=FALSE}
learnrhash::encoder_ui(
  ui_before = shiny::div(
    "When you have completed this tutorial, follow these steps:",
        br(),
    tags$ol(
       tags$li("Click Generate Submission"),
       tags$li("Copy and paste the hash generated into the \"Hash\" textbox"),
       tags$li("Press 'Create responses.rds'. Nothing will pop up, but this will create an .rds file of your hashed responses."),
       tags$li("Download the .rds file. A window will pop up asking you where to place the downloaded file. Upload this file to the appropriate Canvas assignment."))
  )
)
```

```{r context="setup"}
fluidPage(
    mainPanel(
          div(id = "form",
            textInput("hash", "Hash", ""),
            actionButton("submit", "Create responses.rds", class = "btn-primary"),
            downloadButton("downloadData", "Download responses.rds")
          )
        )
    )
```

```{r context="server"}

learnrhash::encoder_logic()

 observeEvent(input$submit,{
        hash_id <<- input$hash
        responses <<- data.frame("Hash" = hash_id)
 })
output$downloadData <- downloadHandler(
      filename = "tutorial_1_responses.rds",
      content = function(file) {
      write_rds(responses, file)
    }
  )
```


